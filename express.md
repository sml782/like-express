# express

## 核心依赖

`NodeJS` 的 `http` 模块为基础

- 依赖创建的服务
- 添加中间层处理
- 再次丰富扩展 `req` 、 `res` 的属性及方法

## 核心机制

### 什么是中间件？

1. 处理程序，就是处理 `http` 请求的函数

### 注册中间件(也就是注册路由)

1. `use()`: 注册所有系统中间件，通用
2. `all()`: 注册所有方法路由，通用
3. `get()|post()...`: 注册基本方法路由，单方法

### `use()` 和 `all()` 的区别：

1. 注册的东西不同，`use()` 是注册中间件，而 `all()` 是注册路由。
2. 处理的东西，`use()` 一般不处理请求和响应，只处理输入相关数据，而 `all()` 只处理请求和响应。
3. 路由匹配不同，`use()` 是只要配置路由在当前路径首位就能匹配到并执行，而 `all()` 等则是精确匹配。

### 中间件怎么执行?

1. 一个一个串联起来，形成执行栈执行队列
2. 通过中间件管理器来操作下一步应该干啥
3. 顺序执行，传递执行
4. 如果到最后都没找到，直接进入404处理
5. 如遇到错误，处理首先寻找自定义`errorhandle` ，有则执行，没有执行内部定义 `errorhandle`;

